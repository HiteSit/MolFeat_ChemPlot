

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Similarity Analysis &mdash; ChemPlot 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dimensionality Reduction" href="dimreduction.html" />
    <link rel="prev" title="How to use ChemPlot" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ChemPlot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Manual:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">How to use ChemPlot</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Similarity Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structural">Structural</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tailored">Tailored</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dimreduction.html">Dimensionality Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_features.html">Additional Features</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ChemPlot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Similarity Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user_manual/similarity.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="similarity-analysis">
<h1>Similarity Analysis<a class="headerlink" href="#similarity-analysis" title="Permalink to this headline">¶</a></h1>
<p>In this example we will use two molecular datasets: the BBBP (blood-brain
barrier penetration) dataset <a class="footnote-reference brackets" href="#id5" id="id1">1</a>, already used in the previous section, and
the BACE (β-secretase inhibitors) dataset <a class="footnote-reference brackets" href="#id6" id="id2">2</a>. While the target values of the
molecules collected by the BBBP dataset are binary, and therefore discrete, the
target values of the molecules collected by the BACE dataset are continuous.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">chemplot</span> <span class="k">as</span> <span class="nn">cp</span>

<span class="n">data_BBBP</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;BBBP.csv&quot;</span><span class="p">)</span>
<span class="n">data_BACE</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;BACE.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to plot a subset of the chemical space over a 2D graph it is necessary to
define the metric according to which a certain molecule will be plotted on a certain
location of the graph. What ChemPlot uses when deciding which molecules
need to be plotted where is the concept of “molecular similarity”. Similar molecules will
be displayed closer together, while molecules which are less similar will be displayed further apart.</p>
<p>ChemPlot distinguishes between two definitions of molecular similarity: structural and tailored <a class="footnote-reference brackets" href="#id7" id="id3">3</a>.</p>
<div class="section" id="structural">
<h2>Structural<a class="headerlink" href="#structural" title="Permalink to this headline">¶</a></h2>
<p>Structural similarity is defined as the number and dimensions of “fragments”
different molecules share. Molecular fragments are groups of atoms and bonds
which a molecule can be divided into. The higher the number and dimensions of
fragments two molecules share the more similar they are according to structural
similarity. ChemPlot uses Extended-Connectivity Fingerprints (ECFPs) <a class="footnote-reference brackets" href="#id8" id="id4">4</a> to
define which fragments are present in each molecule. To create a <code class="docutils literal notranslate"><span class="pre">Plotter</span></code>
object which visualizes the desired molecules according to structural
similarity we need to pass the keyword “structural” as the <code class="docutils literal notranslate"><span class="pre">sim_type</span></code>
parameter when constructing the object.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp_BBBP</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Plotter</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">data_BBBP</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">target</span><span class="o">=</span><span class="n">data_BBBP</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">],</span> <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="s2">&quot;structural&quot;</span><span class="p">)</span>
<span class="n">cp_BACE</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Plotter</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">data_BACE</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">target</span><span class="o">=</span><span class="n">data_BACE</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">],</span> <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="s2">&quot;structural&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp_BBBP</span><span class="o">.</span><span class="n">tsne</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tsne_struct_bbbp.png"><img alt="../_images/tsne_struct_bbbp.png" src="../_images/tsne_struct_bbbp.png" style="width: 600px;" /></a>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp_BACE</span><span class="o">.</span><span class="n">tsne</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tsne_struct_bace.png"><img alt="../_images/tsne_struct_bace.png" src="../_images/tsne_struct_bace.png" style="width: 600px;" /></a>
</div>
<div class="section" id="tailored">
<h2>Tailored<a class="headerlink" href="#tailored" title="Permalink to this headline">¶</a></h2>
<p>Tailored similarity is a similarity metric between molecules which takes into
account the target property for determining if two molecules are similar or
not. Indeed after a general set of descriptors is calculated for each molecule,
a subset of those is selected by optimizing for the target property. Finally
depending on the values of the subset ChemPlot can decide which
molecules are more similar than others. To create a <code class="docutils literal notranslate"><span class="pre">Plotter</span></code> object which
visualizes the desired molecules according to structural similarity, we need to
pass the keyword “tailored” as the <code class="docutils literal notranslate"><span class="pre">sim_type</span></code> parameter when constructing the
object. Since “tailored” is the default value of <code class="docutils literal notranslate"><span class="pre">sim_type</span></code> if a list of
target values is passed in construction, in the following example we could have
omitted the last parameter and still have got the same objects.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp_BBBP</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Plotter</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">data_BBBP</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">target</span><span class="o">=</span><span class="n">data_BBBP</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">],</span> <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="s2">&quot;tailored&quot;</span><span class="p">)</span>
<span class="n">cp_BACE</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Plotter</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">data_BACE</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">],</span> <span class="n">target</span><span class="o">=</span><span class="n">data_BACE</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">],</span> <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="s2">&quot;tailored&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp_BBBP</span><span class="o">.</span><span class="n">tsne</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/gs_tsne.png"><img alt="../_images/gs_tsne.png" src="../_images/gs_tsne.png" style="width: 600px;" /></a>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp_BACE</span><span class="o">.</span><span class="n">tsne</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/bace_tsne.png"><img alt="../_images/bace_tsne.png" src="../_images/bace_tsne.png" style="width: 600px;" /></a>
<hr class="docutils" />
<h3><p>References:</p>
</h3><dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><strong>Martins, Ines Filipa, et al.</strong> (2012). <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/22612593/">A Bayesian approach to in silico blood-brain barrier penetration modeling.</a> Journal of chemical information and modeling 52.6, 1686-1697</p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><strong>Subramanian, Govindan, et al.</strong> (2016). <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jcim.6b00290">Computational modeling of β-secretase 1 (BACE-1) inhibitors using ligand based approaches.</a> Journal of chemical information and modeling 56.10, 1936-1949.</p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p><strong>Basak, S.C. and Grunwald, G.D.</strong> (1995) <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/7670865/">Predicting mutagenicity of chemicals using topological and quantum chemical parameters: a similarity based study.</a> Chemosphere 31, 2529–2546</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p><strong>Rogers, D., Hahn, M.</strong> (2010).** <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/ci100050t?casa_token=8yftVD_mu2MAAAAA:AZ7G0odektS9wBMyUoQY1s-SfJRsLWOJAAeBbx4fS7d0ed5iivX5T_CpoldVtqtziLDhvxaAiZvCUw">Extended-connectivity fingerprints.</a> Journal of chemical information and modeling, 50(5), 742-754.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dimreduction.html" class="btn btn-neutral float-right" title="Dimensionality Reduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="getting_started.html" class="btn btn-neutral float-left" title="How to use ChemPlot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Dajt Mullaj, Murat Cihan Sorkun.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>